<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- 上述3个meta标签*必须*放在最前面，任何其他内容都*必须*跟随其后！ -->

    <script src="https://cdn.bootcss.com/jquery/3.3.1/jquery.min.js"></script>
    {% block meta %}<!-- block meta -->{% endblock %}
    <title>{% block title %} ? {% endblock %}-Awesome Python Webapp</title>

    <!-- Bootstrap -->
    <link href="../static/css/bootstrap.min.css" rel="stylesheet">
    <link href="../static/css/awsome.css" rel="stylesheet">
    <script src="../static/js/vue.min.js"></script>
    <script>
      $(function() {
  var vm = new Vue({
      el:'#vm',
      data:{
        name:'',
        email:'',
        password1:'',
        password2:''
      },
      methods:{
        submit:function(event){
          event.preventDefault();
          var $form = $('#vm');
          if (! this.name.trim()) {
            return $form.showFormError('请输入名字');
          }
          if (! validateEmail(this.email.trim().toLowerCase())) {
            return $form.showFormError('请输入正确的Email地址');
          }
          if (this.password1.length <6) {
            return $form.showFormError('密码的长度不能少于6个字符');
          }
          if (this.password1 != this.password2) {
            return $form.showFormError('两次密码不一致！');
          }
          var email = this.email.trim().toLowerCase();
          $form.postJSON('/api/users',{
            name: this.name.trim(),
            email: email,
            passwd: CryptoJS.SHA1(email + ':' + this.password1).toString()
            },function (err,r) {
              if (err) {
                return $form.showFormError(err);
              }
              return location:assign('/');
            });
        }
      }
    
    });
    $('#vm').show();
  });
    </script>


  </head>
  <body>
    <div class="col-xs-12 col-md-8">
    <h1>欢迎注册！</h1>
    <form id="vm" v-on="submit:submit" class="margin-btm">
      <div class=""></div>
      <div class="form-group">
        <label class="">名字：</label>
        <div class="form-group">
          <input type="text" maxlength="50" placeholder="名字" class="" v-model="name">
        </div>
      </div>
      <div class="form-group">
        <label class="">电子邮件：</label>
        <div class="">
          <input type="text" maxlength="50" placeholder="你的邮件地址" class="" v-model="email">
        </div>
      </div>
      <div class="form-group">
        <label class="">密码：</label>
        <div class="">
          <input type="password" maxlength="50" placeholder="输入密码" class="" v-model="password1">
        </div>
      </div>
      <div class="form-group">
        <label class="">再次输入密码：</label>
        <div class="">
          <input type="password" maxlength="50" placeholder="再次输入密码" class="" v-model="password2">
        </div>
      </div>
      <div>
        <button type="submit" class="btn btn-primary"><i class="glyphicon glyphicon-user"></i> 注册</button>
      </div>
    </form>
  </div>
  <div class="col-xs-6 col-md-4"></div>
    <!-- jQuery (Bootstrap 的所有 JavaScript 插件都依赖 jQuery，所以必须放在前边) -->
    <!-- 加载 Bootstrap 的所有 JavaScript 插件。你也可以根据需要只加载单个插件。 -->
    <script src="../static/js/bootstrap.min.js"></script>
  </body>
</html>